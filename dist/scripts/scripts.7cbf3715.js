"use strict";function MainCtrl(){}function NavUserCtrl(a,b){var c=this;a.$watch(function(){return b.logged()},function(a){c.logged=a},!0),a.$watch(function(){return b.userName()},function(a){c.name=a},!0)}function ExploreCtrl(a,b,c,d,e,f){var g=this;a.eventMarkers=[],a.$watch(function(){return d.getMap()},function(b){a.map=b},!0),a.$watch(function(){return c.getCurrentEventList()},function(b){if(null!=b&&b.length>0){g.eventList=b;var c=[],d=[];angular.forEach(b,function(a,b){var d={latitude:a.position.lat,longitude:a.position.lng,title:a.description};d.id=b,c.push(d)},d),a.eventMarkers=c}else g.eventList=null},!0),a.$watch(function(){return c.getFilter()},function(a){g.filterList=a.list,g.eventsHeader=a.name,g.filtersHeader=a.type},!0),g.allEvents=function(){var a=c.getAllEvents();a.then(function(a){c.setCurrentEventList(a.data,"All events")})["catch"](function(a){console.log("Error: "+a)})},g.allHunters=function(){var a=e.getAllHunters();a.then(function(a){c.setFilter(a.data,"hunters")})["catch"](function(a){console.log("Error: "+a)})},g.allTags=function(){var a=f.getAllTags();a.then(function(a){c.setFilter(a.data,"tags")})["catch"](function(a){console.log("Error: "+a)})},g.gotoEvent=function(a){d.setCenter({latitude:a.lat,longitude:a.lng})},g.queryEvents=function(){if(g.eventQuery){var a=c.getEventsByQuery(g.eventQuery);a.then(function(a){c.setCurrentEventList(a.data,"Events with: '"+g.eventQuery+"'"),g.eventsHeader="Events with '"+g.eventQuery+"'"})["catch"](function(a){console.log("Error: "+a)})}},g.allEvents()}function AccountCtrl(a,b,c,d,e){var f=this;if(b.logged()){a.$watch(function(){return c.getCurrentEventList()},function(a){f.eventList=a},!0),f.name=b.userName();var g=b.userId();a.map=d.eventMap;var h=c.getEventsByHunter(g);h.then(function(a){c.setCurrentEventList(a.data,"Events by hunter: "+b.userName())})["catch"](function(a){console.log("Error: "+a)})}else e.path("/");f.addEvent=function(){var a=f.tag.split(","),d=[],e=[];angular.forEach(a,function(a){d.push({name:a.trim()})},e);var g={event:{description:f.desc,position_attributes:{lat:f.latitude,lng:f.longitude},tags:d}},h=c.addEvent(g,b.userToken());h.then(function(a){c.appendCurrentEventList(a.data)})["catch"](function(a){console.log("Error: "+a.data)})},f.removeEvent=function(a){var d=c.removeEvent(a,b.userToken());d.then(function(){c.popCurrentEventList(a)})["catch"](function(a){console.log("Error: "+a.data)})},f.editEvent=function(a){f.changeId=a.id,f.changeDesc=a.description},f.changeEvent=function(){var a={event:{description:f.changeDesc}},d=f.changeId,e=c.editEvent(a,b.userToken(),d);e.then(function(a){c.popCurrentEventList(d),c.appendCurrentEventList(a.data)})["catch"](function(a){console.log("Error: "+a.data)})}}function AccountSignInCtrl(a,b,c){var d=this;d.signIn=function(){var a=b.signIn(d.mail,d.password);a.then(function(a){void 0!==a.data&&(b.user.token=a.data.auth_token,b.user.name=a.data.hunter_name,b.user.id=a.data.hunter_id,b.user.logged=!0,c.path("/account/profile"))})["catch"](function(a){console.log("Error: "+a.data.error)})}}function AccountSignOutCtrl(a,b){b.signOut()}function AccountSignUpCtrl(a,b,c){var d=this;d.signUp=function(){var a=b.signUp(d.name,d.mail,d.pass,d.confirm);a.then(function(a){void 0!==a.data&&c.path("/account/signin")})["catch"](function(a){console.log("Error: "+a.data.error)})}}function HaTrophyApiService(a){function b(b,c){var d={method:"Get",url:k+b+"/"+c,headers:{Authorization:l}};return a(d)}function c(b){var c={method:"Get",url:k+b,headers:{Authorization:l}};return a(c)}function d(b,c,d){var e={method:"Get",url:k+c+"/"+d+"/"+b,headers:{Authorization:l}};return a(e)}function e(b,c){var d={method:"Get",url:k+b+"/query?query="+c,headers:{Authorization:l}};return a(d)}function f(b,c,d,e){var f={method:"Post",url:k+"/hunters",headers:{Authorization:l},params:{name:b,email:c,password:d,password_confirmation:e}};return a(f)}function g(b,c){var d={method:"Post",url:k+"/auth",params:{email:b,password:c}};return a(d)}function h(b,c,d){var e={method:"Post",url:k+"/events",headers:{Authorization:l,"X-JWT":d},data:c};return a(e)}function i(b,c,d,e){var f={method:"Put",url:k+"/events/"+e,headers:{Authorization:l,"X-JWT":d},data:c};return a(f)}function j(b,c,d){var e={method:"Delete",url:k+"/events/"+c,headers:{Authorization:l,"X-JWT":d}};return a(e)}var k="http://127.0.0.1:3000/api/",l="Token token=3acff13b44739f59cc7b9f735f67fbb7";return{getSingle:b,getCollection:c,getCollBySingle:d,getCollByQuery:e,postNewHunter:f,postHunterAuth:g,addSingle:h,editSingle:i,removeSingle:j}}function HaAuthService(a){function b(b,c,d,e){return a.postNewHunter(b,c,d,e)}function c(b,c){return a.postHunterAuth(b,c)}function d(){return i.name=null,i.token=null,i.id=null,i.logged=!1,!0}function e(){return i.logged}function f(){return i.name}function g(){return i.token}function h(){return i.id}var i={name:null,token:null,id:null,logged:!1};return{signUp:b,signIn:c,signOut:d,user:i,logged:e,userName:f,userToken:g,userId:h}}function HaEventService(a){function b(b){return a.getSingle("events",b)}function c(){return a.getCollection("events")}function d(b){return a.getCollBySingle("events","tags",b)}function e(b){return a.getCollBySingle("events","hunters",b)}function f(b){return a.getCollByQuery("events",b)}function g(b,c){return a.addSingle("events",b,c)}function h(b,c,d){return a.editSingle("events",b,c,d)}function i(b,c){return a.removeSingle("events",b,c)}function j(a,b){p=a,q.name=b}function k(){return p}function l(a){p.unshift(a)}function m(a){var b=[];angular.forEach(p,function(b,c){b.id===a&&p.splice(c,1)},b)}function n(a,b){q.list=a,q.type=b}function o(){return q}var p=null,q={list:null,type:null,name:null};return{getEvent:b,getAllEvents:c,getEventsByTag:d,getEventsByHunter:e,getEventsByQuery:f,addEvent:g,editEvent:h,removeEvent:i,setCurrentEventList:j,getCurrentEventList:k,appendCurrentEventList:l,popCurrentEventList:m,setFilter:n,getFilter:o}}function HaTagService(a){function b(){return a.getCollection("tags")}var b;return{getAllTags:b}}function HaHunterService(a){function b(){return a.getCollection("hunters")}var b;return{getAllHunters:b}}function HaEventsMapService(){function a(){return c}function b(a){c.center=a}var c={center:{latitude:60.2,longitude:20},zoom:9};return{getMap:a,setCenter:b}}function haButtonFilter(){return{restrict:"E",scope:{itemId:"@",itemName:"@"},template:'<button class="link" type="button">{{ itemName }}</button>',link:function(a,b,c){b.bind("click",function(){a.test(c.itemId,c.itemName)})},controller:["$scope","HaEventService",function(a,b){a.test=function(a,c){var d,e,f=b.getFilter().type;"hunters"===f?(d=b.getEventsByHunter(a),e="Events by hunter: "+c):"tags"===f?(d=b.getEventsByTag(a),e="Events by tag: "+c):console.log("Error: incorrect filter list"),d.then(function(a){b.setCurrentEventList(a.data,e)})["catch"](function(a){console.log("Error: "+a)})}}]}}angular.module("hunterApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","uiGmapgoogle-maps"]).config(["$routeProvider","uiGmapGoogleMapApiProvider","$locationProvider",function(a,b){b.configure({v:"3.17",libraries:"weather,geometry,visualization"}),a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"events"}).when("/explore",{templateUrl:"views/eventList.html",controller:"ExploreCtrl",controllerAs:"events"}).when("/explore/hunters/:id/events",{templateUrl:"views/eventList.html",controller:"ExploreByHunterCtrl",controllerAs:"events"}).when("/explore/tags/:id/events",{templateUrl:"views/eventList.html",controller:"ExploreByTagCtrl",controllerAs:"events"}).when("/explore/events/query",{templateUrl:"views/eventList.html",controller:"ExploreByQueryCtrl",controllerAs:"events"}).when("/account/signup",{templateUrl:"views/accountSignUp.html",controller:"AccountSignUpCtrl",controllerAs:"hunter"}).when("/account/signin",{templateUrl:"views/accountSignIn.html",controller:"AccountSignInCtrl",controllerAs:"hunter"}).when("/account/signout",{templateUrl:"views/main.html",controller:"AccountSignOutCtrl"}).when("/account/profile",{templateUrl:"views/accountProfile.html",controller:"AccountCtrl",controllerAs:"hunter"}).otherwise({redirectTo:"/"})}]),angular.module("hunterApp").controller("MainCtrl",MainCtrl),MainCtrl.$inject=["$scope","HaAuthService"],angular.module("hunterApp").controller("NavUserCtrl",NavUserCtrl),NavUserCtrl.$inject=["$scope","HaAuthService"],angular.module("hunterApp").controller("ExploreCtrl",ExploreCtrl),ExploreCtrl.$inject=["$scope","HaAuthService","HaEventService","HaEventsMapService","HaHunterService","HaTagService"],angular.module("hunterApp").controller("AccountCtrl",AccountCtrl),AccountCtrl.$inject=["$scope","HaAuthService","HaEventService","HaEventsMapService","$location"],angular.module("hunterApp").controller("AccountSignInCtrl",AccountSignInCtrl),AccountSignInCtrl.$inject=["$scope","HaAuthService","$location"],angular.module("hunterApp").controller("AccountSignOutCtrl",AccountSignOutCtrl),AccountSignOutCtrl.$inject=["$scope","HaAuthService"],angular.module("hunterApp").controller("AccountSignUpCtrl",AccountSignUpCtrl),AccountSignUpCtrl.$inject=["$scope","HaAuthService","$location"],angular.module("hunterApp").factory("HaTrophyApiService",HaTrophyApiService),HaTrophyApiService.$inject=["$http"],angular.module("hunterApp").factory("HaAuthService",HaAuthService),HaAuthService.$inject=["HaTrophyApiService"],angular.module("hunterApp").factory("HaEventService",HaEventService),HaEventService.$inject=["HaTrophyApiService"],angular.module("hunterApp").factory("HaTagService",HaTagService),HaTagService.$inject=["HaTrophyApiService"],angular.module("hunterApp").factory("HaHunterService",HaHunterService),HaHunterService.$inject=["HaTrophyApiService"],angular.module("hunterApp").factory("HaEventsMapService",HaEventsMapService),angular.module("hunterApp").directive("haButtonFilter",haButtonFilter);